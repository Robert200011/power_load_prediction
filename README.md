# ç”µåŠ›è´Ÿè·é¢„æµ‹ç³»ç»Ÿ

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![XGBoost](https://img.shields.io/badge/XGBoost-1.7+-orange.svg)](https://xgboost.ai/)

åŸºäºæœºå™¨å­¦ä¹ çš„ç”µåŠ›è´Ÿè·é¢„æµ‹ç³»ç»Ÿï¼Œé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒä¸€é”®è¿è¡Œå®Œæ•´çš„æ•°æ®æŒ–æ˜æµç¨‹ã€‚

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†è¯´æ˜](#è¯¦ç»†è¯´æ˜)
- [å®éªŒç»“æœ](#å®éªŒç»“æœ)
- [æœªæ¥æ”¹è¿›](#æœªæ¥æ”¹è¿›)
- [å‚è€ƒèµ„æ–™](#å‚è€ƒèµ„æ–™)

## é¡¹ç›®ç®€ä»‹

ç”µåŠ›è´Ÿè·é¢„æµ‹æ˜¯ç”µç½‘è°ƒåº¦å’Œèƒ½æºç®¡ç†çš„æ ¸å¿ƒä»»åŠ¡ã€‚å‡†ç¡®çš„è´Ÿè·é¢„æµ‹å¯ä»¥ä¼˜åŒ–å‘ç”µè®¡åˆ’ã€é™ä½è¿è¥æˆæœ¬ã€æé«˜ç”µç½‘ç¨³å®šæ€§ã€‚æœ¬é¡¹ç›®æ„å»ºäº†ä¸€ä¸ªå®Œæ•´çš„æœºå™¨å­¦ä¹ é¢„æµ‹ç³»ç»Ÿï¼Œé€šè¿‡æ¯”è¾ƒå¤šç§ç®—æ³•ï¼Œå®ç°é«˜ç²¾åº¦çš„ç”µåŠ›è´Ÿè·é¢„æµ‹ã€‚

### ä¸»è¦ç›®æ ‡

- æ„å»ºå®Œæ•´çš„æ•°æ®æŒ–æ˜æµç¨‹ï¼ˆé¢„å¤„ç†â†’ç‰¹å¾å·¥ç¨‹â†’å»ºæ¨¡â†’è¯„ä¼°ï¼‰
- æ¯”è¾ƒä¸åŒå¤æ‚åº¦çš„æœºå™¨å­¦ä¹ ç®—æ³•æ€§èƒ½
- å®ç°æ¨¡å—åŒ–ã€å¯æ‰©å±•çš„ä»£ç æ¶æ„
- è‡ªåŠ¨ç”Ÿæˆå¯è§†åŒ–ç»“æœå’Œè¯„ä¼°æŠ¥å‘Š

## åŠŸèƒ½ç‰¹æ€§

âœ… **æ¨¡å—åŒ–è®¾è®¡** - å„ä¸ªæ­¥éª¤ç‹¬ç«‹å°è£…ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•  
âœ… **ä¸€é”®è¿è¡Œ** - æ”¯æŒå®Œæ•´æµç¨‹è‡ªåŠ¨æ‰§è¡Œï¼Œæ”¯æŒæ–­ç‚¹ç»­è·‘  
âœ… **å¤šæ¨¡å‹å¯¹æ¯”** - çº¿æ€§å›å½’ã€éšæœºæ£®æ—ã€XGBoostä¸‰ç§ç®—æ³•  
âœ… **è‡ªåŠ¨åŒ–è¯„ä¼°** - è‡ªåŠ¨ç”Ÿæˆæ€§èƒ½å¯¹æ¯”å›¾ã€é¢„æµ‹å¯è§†åŒ–ã€ç‰¹å¾é‡è¦æ€§åˆ†æ  
âœ… **é«˜é¢„æµ‹ç²¾åº¦** - XGBoostæ¨¡å‹RÂ²è¾¾åˆ°97.91%  
âœ… **å®Œæ•´æ–‡æ¡£** - åŒ…å«Jupyter Notebookäº¤äº’å¼åˆ†æ

## é¡¹ç›®ç»“æ„

```
power_load_prediction/
â”œâ”€â”€ main.py                          # ä¸»ç¨‹åºå…¥å£ï¼Œä¸€é”®è¿è¡Œå®Œæ•´æµç¨‹
â”œâ”€â”€ requirements.txt                 # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ README.md                        # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”‚
â”œâ”€â”€ src/                             # æºä»£ç æ¨¡å—
â”‚   â”œâ”€â”€ data_preprocessing.py       # æ•°æ®é¢„å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ feature_engineering.py      # ç‰¹å¾å·¥ç¨‹æ¨¡å—
â”‚   â”œâ”€â”€ model_training.py           # æ¨¡å‹è®­ç»ƒæ¨¡å—
â”‚   â””â”€â”€ evaluation.py               # æ¨¡å‹è¯„ä¼°æ¨¡å—
â”‚
â”œâ”€â”€ data/                            # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ synthetic_load.csv          # åŸå§‹æ•°æ®é›†
â”‚   â”œâ”€â”€ processed_data.csv          # é¢„å¤„ç†åçš„æ•°æ®
â”‚   â””â”€â”€ featured_data.csv           # ç‰¹å¾å·¥ç¨‹åçš„æ•°æ®
â”‚
â”œâ”€â”€ models/                          # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚   â”œâ”€â”€ linear_regression.pkl       # çº¿æ€§å›å½’æ¨¡å‹
â”‚   â”œâ”€â”€ random_forest.pkl           # éšæœºæ£®æ—æ¨¡å‹
â”‚   â”œâ”€â”€ xgboost.pkl                 # XGBoostæ¨¡å‹
â”‚   â””â”€â”€ scaler.pkl                  # ç‰¹å¾æ ‡å‡†åŒ–å™¨
â”‚
â”œâ”€â”€ results/                         # è¯„ä¼°ç»“æœ
â”‚   â”œâ”€â”€ metrics_comparison.png      # æ¨¡å‹æ€§èƒ½å¯¹æ¯”å›¾
â”‚   â”œâ”€â”€ predictions.png             # é¢„æµ‹ç»“æœå¯è§†åŒ–
â”‚   â”œâ”€â”€ feature_importance.png      # ç‰¹å¾é‡è¦æ€§åˆ†æ
â”‚   â””â”€â”€ evaluation_report.txt       # è¯¦ç»†è¯„ä¼°æŠ¥å‘Š
â”‚
â””â”€â”€ notebooks/                       # Jupyter Notebooks
    â””â”€â”€ complete_analysis.ipynb     # å®Œæ•´çš„äº¤äº’å¼åˆ†æ
```

## ç¯å¢ƒé…ç½®

### ç³»ç»Ÿè¦æ±‚

- Python 3.8+
- pip æˆ– conda åŒ…ç®¡ç†å™¨

### å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨pipå®‰è£…
pip install -r requirements.txt

# æˆ–è€…å•ç‹¬å®‰è£…
pip install pandas numpy matplotlib seaborn scikit-learn xgboost jupyter joblib
```

### ä¾èµ–åŒ…è¯´æ˜

| åŒ…å | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| pandas | â‰¥1.3.0 | æ•°æ®å¤„ç†å’Œåˆ†æ |
| numpy | â‰¥1.21.0 | æ•°å€¼è®¡ç®— |
| matplotlib | â‰¥3.4.0 | æ•°æ®å¯è§†åŒ– |
| seaborn | â‰¥0.11.0 | ç»Ÿè®¡å›¾è¡¨ |
| scikit-learn | â‰¥0.24.0 | æœºå™¨å­¦ä¹ ç®—æ³• |
| xgboost | â‰¥1.4.0 | æ¢¯åº¦æå‡ç®—æ³• |
| joblib | â‰¥1.0.0 | æ¨¡å‹æŒä¹…åŒ– |
| jupyter | â‰¥1.0.0 | äº¤äº’å¼åˆ†æ |

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä¸€é”®è¿è¡Œï¼ˆæ¨èï¼‰

```bash
python main.py
```

ç¨‹åºä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
1. æ•°æ®é¢„å¤„ç†
2. ç‰¹å¾å·¥ç¨‹
3. æ¨¡å‹è®­ç»ƒ
4. æ¨¡å‹è¯„ä¼°å’Œç»“æœç”Ÿæˆ

> ğŸ’¡ **æç¤º**ï¼šç¨‹åºæ”¯æŒæ–­ç‚¹ç»­è·‘ã€‚å¦‚æœæ£€æµ‹åˆ°å·²å®Œæˆçš„æ­¥éª¤ï¼Œä¼šè‡ªåŠ¨è·³è¿‡ã€‚

### æ–¹å¼äºŒï¼šåˆ†æ­¥æ‰§è¡Œ

```bash
# æ­¥éª¤1ï¼šæ•°æ®é¢„å¤„ç†
python src/data_preprocessing.py

# æ­¥éª¤2ï¼šç‰¹å¾å·¥ç¨‹
python src/feature_engineering.py

# æ­¥éª¤3ï¼šæ¨¡å‹è®­ç»ƒ
python src/model_training.py

# æ­¥éª¤4ï¼šæ¨¡å‹è¯„ä¼°
python src/evaluation.py
```

### æ–¹å¼ä¸‰ï¼šJupyter Notebook

```bash
jupyter notebook notebooks/complete_analysis.ipynb
```

äº¤äº’å¼åœ°æ¢ç´¢æ•°æ®å’Œæ¨¡å‹ç»“æœã€‚

## è¯¦ç»†è¯´æ˜

### 1. æ•°æ®é¢„å¤„ç†

**è¾“å…¥**: `data/synthetic_load.csv`  
**è¾“å‡º**: `data/processed_data.csv`

ä¸»è¦å¤„ç†æ­¥éª¤ï¼š

- **æ—¶é—´ç‰¹å¾æå–**
  - å¹´ã€æœˆã€æ—¥ã€å°æ—¶ã€æ˜ŸæœŸã€å­£åº¦
  - æ˜¯å¦å‘¨æœ«ï¼ˆäºŒå€¼ç‰¹å¾ï¼‰

- **ç¼ºå¤±å€¼å¤„ç†**
  - æ£€æµ‹ç¼ºå¤±å€¼æ•°é‡
  - ä½¿ç”¨å‰å‘å¡«å……æ³•ï¼ˆforward fillï¼‰ä¿æŒæ•°æ®è¿ç»­æ€§

- **å¼‚å¸¸å€¼æ£€æµ‹**
  - Z-scoreæ–¹æ³•ï¼ˆé˜ˆå€¼ï¼š3å€æ ‡å‡†å·®ï¼‰
  - ç”¨ä¸­ä½æ•°æ›¿æ¢å¼‚å¸¸å€¼

```python
from src.data_preprocessing import DataPreprocessor

preprocessor = DataPreprocessor('data/synthetic_load.csv')
preprocessor.load_data()
preprocessor.handle_datetime()
preprocessor.handle_missing_values()
preprocessor.handle_outliers()
preprocessor.save_processed_data('data/processed_data.csv')
```

### 2. ç‰¹å¾å·¥ç¨‹

**è¾“å…¥**: `data/processed_data.csv`  
**è¾“å‡º**: `data/featured_data.csv`

åˆ›å»ºçš„ç‰¹å¾ç±»å‹ï¼š

- **æ»åç‰¹å¾** (Lag Features)
  - 1å°æ—¶ã€2å°æ—¶ã€3å°æ—¶å‰çš„è´Ÿè·
  - 24å°æ—¶å‰çš„è´Ÿè·ï¼ˆæ—¥å‘¨æœŸæ€§ï¼‰
  - 168å°æ—¶å‰çš„è´Ÿè·ï¼ˆå‘¨å‘¨æœŸæ€§ï¼‰

- **æ»šåŠ¨çª—å£ç‰¹å¾** (Rolling Features)
  - 24å°æ—¶æ»šåŠ¨å‡å€¼å’Œæ ‡å‡†å·®
  - 168å°æ—¶æ»šåŠ¨å‡å€¼å’Œæ ‡å‡†å·®

- **äº¤äº’ç‰¹å¾** (Interaction Features)
  - æ¸©åº¦ Ã— å‡æœŸ
  - æ¸©åº¦ Ã— å°æ—¶
  - å‘¨æœ« Ã— å°æ—¶

```python
from src.feature_engineering import FeatureEngineer

engineer = FeatureEngineer('data/processed_data.csv')
engineer.load_data()
feature_cols, target = engineer.prepare_data_for_modeling()
engineer.save_featured_data('data/featured_data.csv')
```

### 3. æ¨¡å‹è®­ç»ƒ

**è¾“å…¥**: `data/featured_data.csv`  
**è¾“å‡º**: `models/*.pkl`

è®­ç»ƒä¸‰ç§æ¨¡å‹ï¼š

| æ¨¡å‹ | å‚æ•°é…ç½® | ç‰¹ç‚¹ |
|------|----------|------|
| **çº¿æ€§å›å½’** | StandardScaleræ ‡å‡†åŒ– | åŸºå‡†æ¨¡å‹ï¼Œå¯è§£é‡Šæ€§å¼º |
| **éšæœºæ£®æ—** | n_estimators=50, max_depth=20 | é›†æˆå­¦ä¹ ï¼ŒæŠ—è¿‡æ‹Ÿåˆ |
| **XGBoost** | n_estimators=50, max_depth=10, lr=0.1 | é«˜æ€§èƒ½ï¼Œå¤„ç†éçº¿æ€§ |

```python
from src.model_training import ModelTrainer

trainer = ModelTrainer('data/featured_data.csv')
trainer.load_data()
trainer.prepare_train_test_split(test_size=0.2)
trainer.train_all_models()
trainer.save_models('models/')
```

### 4. æ¨¡å‹è¯„ä¼°

**è¾“å…¥**: `models/*.pkl`, `data/featured_data.csv`  
**è¾“å‡º**: `results/`ç›®å½•ä¸‹çš„å›¾è¡¨å’ŒæŠ¥å‘Š

è¯„ä¼°æŒ‡æ ‡ï¼š
- **MAE** (Mean Absolute Error) - å¹³å‡ç»å¯¹è¯¯å·®
- **RMSE** (Root Mean Squared Error) - å‡æ–¹æ ¹è¯¯å·®
- **RÂ²** (Coefficient of Determination) - å†³å®šç³»æ•°

```python
from src.evaluation import ModelEvaluator

evaluator = ModelEvaluator('models/', 'data/featured_data.csv')
evaluator.load_models()
evaluator.load_data()
evaluator.evaluate_all_models()
evaluator.plot_metrics_comparison('results/metrics_comparison.png')
evaluator.plot_predictions('results/predictions.png')
evaluator.plot_feature_importance('results/feature_importance.png')
evaluator.generate_report('results/evaluation_report.txt')
```

## å®éªŒç»“æœ

### æ¨¡å‹æ€§èƒ½å¯¹æ¯”

| æ¨¡å‹ | MAE | RMSE | RÂ² Score |
|------|-----|------|----------|
| Linear Regression | 30.52 | 38.68 | 0.9567 |
| Random Forest | 19.17 | 27.25 | 0.9785 |
| **XGBoost** | **19.10** | **26.87** | **0.9791** |

### æœ€ä½³æ¨¡å‹

**XGBoost** åœ¨æ‰€æœ‰æŒ‡æ ‡ä¸Šè¡¨ç°æœ€ä¼˜ï¼š
- RÂ² = **0.9791**ï¼ˆè§£é‡Šäº†97.91%çš„æ•°æ®å˜å¼‚ï¼‰
- RMSE = **26.87**ï¼ˆé¢„æµ‹è¯¯å·®æœ€å°ï¼‰
- MAE = **19.10**ï¼ˆå¹³å‡ç»å¯¹è¯¯å·®æœ€ä½ï¼‰

### å…³é”®å‘ç°

1. **æ»åç‰¹å¾æœ€é‡è¦** - å†å²è´Ÿè·æ˜¯æœ€å¼ºçš„é¢„æµ‹å› å­
2. **æ—¶åºç›¸å…³æ€§æ˜¾è‘—** - 1å°æ—¶å’Œ24å°æ—¶çš„æ»åç‰¹å¾è´¡çŒ®æœ€å¤§
3. **é›†æˆæ–¹æ³•ä¼˜äºçº¿æ€§æ¨¡å‹** - éšæœºæ£®æ—å’ŒXGBoostæ˜¾è‘—ä¼˜äºçº¿æ€§å›å½’

### Top 5 é‡è¦ç‰¹å¾

1. `nat_demand_lag_1` - 1å°æ—¶å‰çš„è´Ÿè·
2. `nat_demand_lag_24` - 24å°æ—¶å‰çš„è´Ÿè·
3. `nat_demand_rolling_mean_24` - 24å°æ—¶æ»šåŠ¨å‡å€¼
4. `nat_demand_rolling_mean_168` - ä¸€å‘¨æ»šåŠ¨å‡å€¼
5. `nat_demand_lag_2` - 2å°æ—¶å‰çš„è´Ÿè·

## æœªæ¥æ”¹è¿›

### çŸ­æœŸä¼˜åŒ–

- [ ] è¶…å‚æ•°è‡ªåŠ¨è°ƒä¼˜ï¼ˆç½‘æ ¼æœç´¢ã€éšæœºæœç´¢ã€è´å¶æ–¯ä¼˜åŒ–ï¼‰
- [ ] äº¤å‰éªŒè¯è¯„ä¼°æ¨¡å‹ç¨³å®šæ€§
- [ ] æ·»åŠ æ›´å¤šç‰¹å¾ï¼ˆå‚…é‡Œå¶å˜æ¢ã€å°æ³¢å˜æ¢ï¼‰

### ä¸­æœŸæ‰©å±•

- [ ] å¼•å…¥æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆLSTMã€GRUã€Transformerï¼‰
- [ ] é›†æˆæ›´å¤šå¤–éƒ¨æ•°æ®ï¼ˆå¤©æ°”é¢„æŠ¥ã€èŠ‚å‡æ—¥ã€ç»æµæŒ‡æ ‡ï¼‰
- [ ] å®ç°å¤šæ­¥é¢„æµ‹ï¼ˆé¢„æµ‹æœªæ¥å¤šä¸ªæ—¶é—´ç‚¹ï¼‰

### é•¿æœŸè§„åˆ’

- [ ] æ„å»ºå®æ—¶é¢„æµ‹ç³»ç»Ÿ
- [ ] è‡ªåŠ¨æ¨¡å‹æ›´æ–°å’Œé‡è®­ç»ƒæœºåˆ¶
- [ ] éƒ¨ç½²ä¸ºWebæœåŠ¡æˆ–API
- [ ] å¯è§†åŒ–ä»ªè¡¨æ¿ï¼ˆDashboardï¼‰

## å‚è€ƒèµ„æ–™

### ç›¸å…³è®ºæ–‡

- [Short-Term Load Forecasting: A Deep Learning Approach](https://arxiv.org/abs/1906.08863)
- [Feature Engineering for Machine Learning](https://www.oreilly.com/library/view/feature-engineering-for/9781491953235/)

### æŠ€æœ¯æ–‡æ¡£

- [Scikit-learn Documentation](https://scikit-learn.org/stable/documentation.html)
- [XGBoost Documentation](https://xgboost.readthedocs.io/)
- [Pandas User Guide](https://pandas.pydata.org/docs/user_guide/index.html)

### æ•°æ®é›†è¯´æ˜

æœ¬é¡¹ç›®ä½¿ç”¨åˆæˆçš„ç”µåŠ›è´Ÿè·æ•°æ®é›†ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š
- `datetime`: æ—¶é—´æˆ³ï¼ˆå°æ—¶çº§ï¼‰
- `nat_demand`: ç”µåŠ›éœ€æ±‚ï¼ˆç›®æ ‡å˜é‡ï¼‰
- `T2M_toc`: æ¸©åº¦æ•°æ®
- `holiday`: æ˜¯å¦å‡æœŸ
- å…¶ä»–æ°”è±¡å’Œæ—¥å†ç‰¹å¾

